<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manual da Bestie - Secando sem Neura</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        bestie: {
                            light: '#ffe4e6', // rose-100
                            DEFAULT: '#fb7185', // rose-400
                            dark: '#be123c', // rose-700
                            bg: '#fff1f2', // rose-50
                        }
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #fff1f2;
            -webkit-tap-highlight-color: transparent;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .typing-indicator span {
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: #fb7185;
            border-radius: 50%;
            animation: typing 1s infinite;
            margin: 0 2px;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes typing {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }
    </style>
</head>
<body class="text-gray-700 pb-20">

    <!-- Header -->
    <header class="fixed top-0 w-full z-40 bg-white/90 backdrop-blur-md shadow-sm border-b border-pink-100">
        <div class="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-full bg-bestie text-white flex items-center justify-center">
                    <i class="fa-solid fa-heart text-sm"></i>
                </div>
                <h1 class="font-bold text-lg text-bestie-dark tracking-wide">Manual da Bestie</h1>
            </div>
            <button class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition">
                <i class="fa-regular fa-bell"></i>
            </button>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="max-w-md mx-auto pt-20 px-4 min-h-screen" id="app-content">
        <!-- Content inject via JS -->
    </main>

    <!-- Recipe Details Modal (Hidden by default) -->
    <div id="recipe-modal" class="fixed inset-0 z-50 hidden">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" onclick="closeRecipeModal()"></div>
        <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-3xl h-[80vh] overflow-y-auto transform transition-transform duration-300 translate-y-full md:max-w-md md:mx-auto md:inset-x-0" id="modal-panel">
            <!-- Modal Content -->
            <div class="relative p-6">
                <!-- Close Button -->
                <button onclick="closeRecipeModal()" class="absolute top-4 right-4 w-8 h-8 bg-gray-100 text-gray-500 rounded-full flex items-center justify-center hover:bg-gray-200 transition z-10">
                    <i class="fa-solid fa-xmark"></i>
                </button>

                <div class="w-12 h-1 bg-gray-300 rounded-full mx-auto mb-6"></div>
                
                <div class="flex justify-between items-start mb-4">
                    <div class="pr-8">
                        <span id="modal-tag" class="text-xs font-semibold text-bestie uppercase tracking-wider bg-pink-50 px-2 py-1 rounded-md">Categoria</span>
                        <h2 id="modal-title" class="text-2xl font-bold text-gray-800 mt-2 leading-tight">Nome da Receita</h2>
                    </div>
                    <div class="flex flex-col items-end flex-shrink-0">
                        <span class="text-lg font-bold text-bestie-dark whitespace-nowrap"><span id="modal-cal">0</span> kcal</span>
                    </div>
                </div>
                
                <p id="modal-desc" class="text-sm text-gray-500 mb-6 italic leading-relaxed">
                    <!-- Description injected here -->
                </p>

                <!-- Dica de Ouro Container -->
                <div id="modal-tip-container" class="hidden mb-6 bg-yellow-50 border border-yellow-200 rounded-xl p-4">
                    <h4 class="text-yellow-700 font-bold text-sm mb-1 flex items-center gap-2">
                        <i class="fa-solid fa-star"></i> Dica de Ouro
                    </h4>
                    <p id="modal-tip-text" class="text-xs text-yellow-800"></p>
                </div>

                <div class="flex items-center gap-4 text-sm text-gray-500 mb-6 border-y border-pink-50 py-4 justify-between px-2">
                    <div class="flex items-center gap-1.5">
                        <i class="fa-regular fa-clock text-bestie"></i>
                        <span id="modal-time">0 min</span>
                    </div>
                    <div class="flex items-center gap-1.5">
                        <i class="fa-solid fa-fire text-bestie"></i>
                        <span id="modal-difficulty">F√°cil</span>
                    </div>
                    <div class="flex items-center gap-1.5">
                        <i class="fa-solid fa-user-group text-bestie"></i>
                        <span id="modal-yield">2 por√ß√µes</span>
                    </div>
                </div>

                <div class="mb-6">
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
                        <i class="fa-solid fa-basket-shopping text-bestie"></i> Ingredientes
                    </h3>
                    <ul id="modal-ingredients" class="space-y-3 text-sm text-gray-600 pl-2">
                        <!-- JS Inject -->
                    </ul>
                </div>

                <div class="mb-8">
                    <h3 class="font-bold text-gray-800 mb-3 flex items-center gap-2">
                        <i class="fa-solid fa-spoon text-bestie"></i> Modo de Preparo
                    </h3>
                    <div id="modal-instructions" class="space-y-4 text-sm text-gray-600">
                        <!-- JS Inject -->
                    </div>
                </div>
                
                <button class="w-full py-3 bg-bestie text-white font-semibold rounded-xl shadow-lg shadow-pink-200 hover:bg-bestie-dark transition active:scale-95 mb-safe">
                    <i class="fa-regular fa-heart mr-2"></i> Salvar nos Favoritos
                </button>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="fixed bottom-0 w-full z-40 bg-white border-t border-pink-100 pb-safe">
        <div class="max-w-md mx-auto px-6 h-16 flex items-center justify-between">
            <button onclick="navigate('home')" class="nav-btn active flex flex-col items-center gap-1 text-bestie">
                <i class="fa-solid fa-house text-xl mb-0.5"></i>
                <span class="text-[10px] font-medium">In√≠cio</span>
            </button>
            <button onclick="navigate('recipes')" class="nav-btn flex flex-col items-center gap-1 text-gray-400 hover:text-bestie transition">
                <i class="fa-solid fa-utensils text-xl mb-0.5"></i>
                <span class="text-[10px] font-medium">Receitas</span>
            </button>
            <div class="relative -top-5">
                <button class="w-12 h-12 rounded-full bg-bestie text-white flex items-center justify-center shadow-lg shadow-pink-300 hover:scale-105 transition">
                    <i class="fa-solid fa-plus text-xl"></i>
                </button>
            </div>
            <button onclick="navigate('calculator')" class="nav-btn flex flex-col items-center gap-1 text-gray-400 hover:text-bestie transition">
                <i class="fa-solid fa-calculator text-xl mb-0.5"></i>
                <span class="text-[10px] font-medium">Calc</span>
            </button>
            <button onclick="navigate('profile')" class="nav-btn flex flex-col items-center gap-1 text-gray-400 hover:text-bestie transition">
                <i class="fa-regular fa-user text-xl mb-0.5"></i>
                <span class="text-[10px] font-medium">Perfil</span>
            </button>
        </div>
    </nav>

    <script>
        // --- GEMINI API SETUP ---
        const apiKey = ""; // Environment will provide key

        // --- USER PROFILE STATE ---
        let userProfile = JSON.parse(localStorage.getItem('bestieProfile')) || {
            name: 'Bestie',
            age: '',
            weight: '',
            targetWeight: '',
            height: '',
            goal: 'perder'
        };

        // --- API FUNCTIONS ---

        async function callGemini(ingredients) {
            const prompt = `Voc√™ √© a 'Bestie Fit', uma chef especialista em receitas saud√°veis, pr√°ticas e com poucas calorias para o aplicativo 'Manual da Bestie'. 
            Crie uma receita criativa e saud√°vel (fit/low carb/proteica) usando OBRIGATORIAMENTE estes ingredientes principais: ${ingredients}. Voc√™ pode sugerir temperos b√°sicos extras.
            
            IMPORTANTE: Responda APENAS com um objeto JSON v√°lido (sem markdown, sem \`\`\`json) seguindo exatamente esta estrutura:
            {
                "title": "Nome Criativo da Receita",
                "calories": 000 (apenas numero),
                "time": "00 min",
                "difficulty": "F√°cil",
                "yield": "1 ou 2 por√ß√µes",
                "description": "Uma descri√ß√£o curta, animada e motivadora estilo 'bestie'. Se houver uma dica especial, comece com 'Dica:'",
                "ingredients": ["ingrediente 1", "ingrediente 2"],
                "instructions": ["passo 1", "passo 2", "passo 3"],
                "category": "almoco" (escolha entre: cafe, almoco, jantar, lanche, doces)
            }`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                    responseMimeType: "application/json"
                }
            };

            try {
                let response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Erro na API');

                const data = await response.json();
                let text = data.candidates[0].content.parts[0].text;
                text = text.replace(/```json/gi, '').replace(/```/g, '').trim();
                return JSON.parse(text);

            } catch (error) {
                console.error("Erro Gemini:", error);
                return null;
            }
        }

        async function callGeminiPlan(userData) {
            const prompt = `Voc√™ √© a 'Bestie Fit', uma nutricionista e coach motivacional. Crie um mini plano personalizado com base nestes dados:
            - Idade: ${userData.age}
            - Peso Atual: ${userData.weight}kg
            - Meta de Peso: ${userData.targetWeight}kg
            - Altura: ${userData.height}cm
            - Objetivo: ${userData.goal}

            IMPORTANTE: Responda APENAS com um objeto JSON v√°lido (sem markdown) com esta estrutura:
            {
                "calories_target": "Ex: 1500-1600",
                "bmi": "Ex: 22.5 (Normal)",
                "macros": {
                    "protein": "Ex: 120g",
                    "carbs": "Ex: 150g",
                    "fats": "Ex: 50g"
                },
                "motivational_quote": "Uma frase curta e inspiradora estilo 'bestie' para motivar.",
                "tip": "Uma dica de ouro espec√≠fica para o objetivo selecionado."
            }`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                    responseMimeType: "application/json"
                }
            };

            try {
                let response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Erro na API');

                const data = await response.json();
                let text = data.candidates[0].content.parts[0].text;
                text = text.replace(/```json/gi, '').replace(/```/g, '').trim();
                const firstOpen = text.indexOf('{');
                const lastClose = text.lastIndexOf('}');
                if (firstOpen !== -1 && lastClose !== -1) {
                    text = text.substring(firstOpen, lastClose + 1);
                }
                return JSON.parse(text);

            } catch (error) {
                console.error("Erro Gemini Plan:", error);
                return null;
            }
        }

        async function callGeminiWorkout(data) {
            const prompt = `Voc√™ √© a 'Bestie Fit', uma personal trainer animada e motivadora. Crie um treino r√°pido e eficiente com estas caracter√≠sticas:
            - Tempo: ${data.time} minutos
            - Foco: ${data.focus}
            - Equipamento: ${data.equipment}

            IMPORTANTE: Responda APENAS com um objeto JSON v√°lido (sem markdown) com esta estrutura:
            {
                "title": "Nome Criativo do Treino",
                "warmup": "Uma frase r√°pida de aquecimento (Ex: 1 min polichinelos)",
                "exercises": [
                    { "name": "Nome do Exerc√≠cio", "reps": "Ex: 3x 12", "tips": "Dica r√°pida de execu√ß√£o" },
                    { "name": "Nome do Exerc√≠cio 2", "reps": "Ex: 3x 15", "tips": "Dica r√°pida" }
                ],
                "motivation": "Frase final de motiva√ß√£o curta e divertida"
            }`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                generationConfig: {
                    responseMimeType: "application/json"
                }
            };

            try {
                let response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Erro na API');

                const data = await response.json();
                let text = data.candidates[0].content.parts[0].text;
                text = text.replace(/```json/gi, '').replace(/```/g, '').trim();
                const firstOpen = text.indexOf('{');
                const lastClose = text.lastIndexOf('}');
                if (firstOpen !== -1 && lastClose !== -1) {
                    text = text.substring(firstOpen, lastClose + 1);
                }
                return JSON.parse(text);

            } catch (error) {
                console.error("Erro Gemini Workout:", error);
                return null;
            }
        }

        async function callGeminiSOS(situation) {
            const prompt = `Voc√™ √© a 'Bestie Fit', a melhor amiga virtual da usu√°ria. A usu√°ria est√° passando por esta situa√ß√£o: "${situation}".
            D√™ um conselho de emerg√™ncia curto, pr√°tico e sem julgamentos (max 2 frases).
            Foque em redu√ß√£o de danos ou motiva√ß√£o imediata. Use tom leve e divertido com emojis.`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }]
            };

            try {
                let response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Erro na API');

                const data = await response.json();
                return data.candidates[0].content.parts[0].text;

            } catch (error) {
                console.error("Erro Gemini SOS:", error);
                return "Oii bestie! T√¥ aqui, respira fundo! Tenta de novo j√° j√°! üíñ";
            }
        }

        async function callGeminiSwap(item) {
            const prompt = `Voc√™ √© a 'Bestie Fit'. A usu√°ria quer substituir '${item}' por algo mais saud√°vel na dieta.
            Sugira a melhor troca fit e explique o porqu√™ em uma frase curta, animada e com emojis. Exemplo: 'Troque por X, porque Y! ‚ú®'`;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }]
            };

            try {
                let response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error('Erro na API');

                const data = await response.json();
                return data.candidates[0].content.parts[0].text;

            } catch (error) {
                console.error("Erro Gemini Swap:", error);
                return "Ops! Minha bola de cristal fit falhou. Tenta de novo! üîÆ";
            }
        }

        // --- DATA ---
        let waterIntake = 0;
        let waterGoalLiters = 2.5;
        let waterGoalCups = 10;

        const recipes = [
            // All recipes...
            { id: 1, title: "Crepioca Fit", displayCategory: "Caf√© da Manh√£", tags: ['cafe', 'proteina', 'zeroacucar', 'simples', 'rapido', 'lowcal'], calories: 180, time: "10 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "A queridinha das dietas! Pr√°tica, r√°pida e vers√°til.", ingredients: ["1 ovo", "2 colheres goma tapioca", "1 colher requeij√£o light", "Sal a gosto"], instructions: ["Bata o ovo com a tapioca.", "Frite em frigideira untada."] },
            { id: 2, title: "Salada de Pote", displayCategory: "Almo√ßo Pr√°tico", tags: ['almoco', 'jantar', 'lowcal', 'lowcarb', 'proteina', 'rapido', 'simples'], calories: 320, time: "15 min", difficulty: "F√°cil", yield: "1 pote", description: "Perfeita para levar para o trabalho.", ingredients: ["Folhas", "100g frango desfiado", "Tomate cereja", "Cenoura", "Molho iogurte"], instructions: ["Molho no fundo.", "Legumes duros.", "Frango.", "Folhas por cima."] },
            { id: 3, title: "Overnight Oats", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'lanche', 'vegetariano'], calories: 250, time: "5 min", difficulty: "Muito F√°cil", yield: "1 pote", description: "Caf√© da manh√£ pronto para quem acorda na correria.", ingredients: ["30g aveia", "Leite vegetal", "Chia", "Frutas"], instructions: ["Misture e gele a noite toda."] },
            { id: 4, title: "Brigadeiro de Whey", displayCategory: "Doce Fit", tags: ['lanche', 'proteina', 'doces'], calories: 120, time: "15 min", difficulty: "F√°cil", yield: "5 bolinhas", description: "Para matar a vontade de doce sem sair da dieta.", ingredients: ["Whey Chocolate", "Cacau", "Leite em p√≥", "√Ågua"], instructions: ["Misture at√© dar ponto."] },
            { id: 5, title: "Panqueca de Banana", displayCategory: "Caf√© da Manh√£", tags: ['cafe', 'lanche', 'lowfat'], calories: 210, time: "10 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Apenas 3 ingredientes.", ingredients: ["1 banana", "2 ovos", "Canela"], instructions: ["Amasse banana, misture com ovos, frite."] },
            { id: 6, title: "Br√≥colis e couve-flor", displayCategory: "Almo√ßo/Jantar", tags: ['almoco', 'jantar', 'lowcarb'], calories: 356, time: "25 min", difficulty: "Normal", yield: "2 por√ß√µes", description: "Gratinado delicioso.", ingredients: ["Br√≥colis", "Couve-flor", "Queijo", "Creme de leite"], instructions: ["Cozinhe legumes, cubra com molho e asse."] },
            { id: 7, title: "Lassi de Manga", displayCategory: "Caf√© da Manh√£", tags: ['cafe', 'lanche', 'vegetariano'], calories: 211, time: "3 min", difficulty: "Muito F√°cil", yield: "2 por√ß√µes", description: "Bebida refrescante.", ingredients: ["Manga", "Iogurte", "Mel"], instructions: ["Bata tudo no liquidificador."] },
            { id: 8, title: "Shake Choco Hortel√£", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'lanche', 'vegano'], calories: 232, time: "3 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Refrescante e doce.", ingredients: ["Cacau", "Hortel√£", "Banana", "Leite vegetal"], instructions: ["Bata tudo no liquidificador."] },
            { id: 9, title: "Smoothie Morango", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'lanche', 'lowcal'], calories: 150, time: "5 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Cl√°ssico.", ingredients: ["Morango", "Banana", "Iogurte"], instructions: ["Bata tudo."] },
            { id: 10, title: "Shake Banana Nozes", displayCategory: "P√≥s-Treino", tags: ['cafe', 'proteina'], calories: 434, time: "5 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Energia pura.", ingredients: ["Banana", "Nozes", "Iogurte", "Mel"], instructions: ["Bata tudo."] },
            { id: 11, title: "Shake Pasta Amendoim", displayCategory: "Proteico", tags: ['lanche', 'proteina'], calories: 402, time: "5 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Favorito dos atletas.", ingredients: ["Pasta de amendoim", "Banana", "Whey", "Leite"], instructions: ["Bata tudo."] },
            { id: 12, title: "Smoothie Banana T√¢mara", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'vegano'], calories: 237, time: "15 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Ado√ßado naturalmente.", ingredients: ["Banana", "T√¢maras", "Leite vegetal"], instructions: ["Hidrate t√¢maras, bata tudo."] },
            { id: 13, title: "Shake Mirtilo Coco", displayCategory: "Proteico Caseiro", tags: ['lanche', 'proteina'], calories: 358, time: "5 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Prote√≠na de qualidade sem aditivos.", ingredients: ["Iogurte Grego", "Mirtilo", "Coco"], instructions: ["Bata tudo."] },
            { id: 14, title: "Shake Frutas Vermelhas", displayCategory: "P√≥s-Treino", tags: ['lanche', 'lowcal'], calories: 163, time: "9 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Leve e proteico.", ingredients: ["Claras", "Frutas vermelhas", "Iogurte"], instructions: ["Bata tudo."] },
            { id: 15, title: "Shake Chocolate Prot", displayCategory: "Pr√©-Treino", tags: ['lanche', 'proteina'], calories: 284, time: "5 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "R√°pido e delicioso.", ingredients: ["Banana", "Whey", "Cacau", "√Ågua"], instructions: ["Bata tudo."] },
            { id: 16, title: "Mingau Aveia Choco", displayCategory: "Caf√© Vegano", tags: ['cafe', 'vegano'], calories: 389, time: "10 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Saciante.", ingredients: ["Aveia", "Cacau", "Banana", "Leite veg"], instructions: ["Cozinhe at√© engrossar."] },
            { id: 17, title: "Cereal Caseiro", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'lowcarb'], calories: 455, time: "85 min", difficulty: "Normal", yield: "4 por√ß√µes", description: "Crocante e saud√°vel.", ingredients: ["Am√™ndoas", "Coco", "Sementes"], instructions: ["Asse em forno baixo."] },
            { id: 18, title: "Overnight Framboesa", displayCategory: "Caf√© Pr√°tico", tags: ['cafe', 'simples'], calories: 286, time: "3h+", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Prepare antes.", ingredients: ["Aveia", "Framboesa", "Leite"], instructions: ["Misture e gele."] },
            { id: 19, title: "Mingau Microondas", displayCategory: "Caf√© R√°pido", tags: ['cafe', 'rapido'], calories: 373, time: "8 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Muito pr√°tico.", ingredients: ["Aveia", "Banana", "√Ågua/Leite"], instructions: ["Microondas 2 min."] },
            { id: 20, title: "Smoothie Verde", displayCategory: "Detox", tags: ['lanche', 'vegano'], calories: 273, time: "5 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Vitaminas.", ingredients: ["Espinafre", "Laranja", "Banana"], instructions: ["Bata tudo."] },
            { id: 21, title: "Cereal Trigo", displayCategory: "Caf√© Caseiro", tags: ['cafe', 'simples'], calories: 413, time: "15 min", difficulty: "Normal", yield: "1 por√ß√£o", description: "Cereal assado.", ingredients: ["Trigo", "Mel", "√ìleo coco"], instructions: ["Asse at√© dourar."] },
            { id: 22, title: "Bruschetta Avocado", displayCategory: "Lanche Salgado", tags: ['lanche', 'vegano'], calories: 427, time: "15 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Refinado.", ingredients: ["P√£o integral", "Avocado", "Tomate"], instructions: ["Monte no p√£o tostado."] },
            { id: 23, title: "Misto Batata Doce", displayCategory: "Pr√©-Treino", tags: ['lanche', 'vegano'], calories: 303, time: "28 min", difficulty: "F√°cil", yield: "3 por√ß√µes", description: "Substituto do p√£o.", ingredients: ["Batata doce", "Pasta amendoim"], instructions: ["Asse batata, recheie."] },
            { id: 24, title: "Geleia Morango Chia", displayCategory: "Doce Fit", tags: ['doces', 'lowcal'], calories: 12, time: "15 min", difficulty: "F√°cil", yield: "20 por√ß√µes", description: "Sem a√ß√∫car.", ingredients: ["Morango", "Chia", "Ado√ßante"], instructions: ["Cozinhe at√© reduzir."] },
            { id: 25, title: "Sandu√≠che Tomate Ovos", displayCategory: "Caf√© Pr√°tico", tags: ['cafe', 'almoco'], calories: 240, time: "15 min", difficulty: "Normal", yield: "2 por√ß√µes", description: "Cl√°ssico.", ingredients: ["P√£o integral", "Ovo", "Tomate", "Iogurte"], instructions: ["Fa√ßa pasta de ovo, monte."] },
            { id: 26, title: "Rabanada Morango", displayCategory: "Caf√© Especial", tags: ['cafe', 'doces'], calories: 260, time: "10 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Vers√£o fit.", ingredients: ["P√£o", "Ovo", "Leite", "Morango"], instructions: ["Molhe p√£o, grelhe."] },
            { id: 27, title: "Triguilho Framboesa", displayCategory: "Caf√© Energia", tags: ['cafe', 'rapido'], calories: 467, time: "10 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Fibras.", ingredients: ["Triguilho", "Iogurte", "Frutas"], instructions: ["Misture."] },
            { id: 28, title: "Ovos Mexidos Espinafre", displayCategory: "Caf√© Low Carb", tags: ['cafe', 'lowcarb'], calories: 546, time: "10 min", difficulty: "F√°cil", yield: "1 por√ß√£o", description: "Salgado.", ingredients: ["Ovos", "Espinafre", "Feta"], instructions: ["Refogue e mexa."] },
            { id: 29, title: "Muffin Banana Choco", displayCategory: "Doce Fit", tags: ['lanche', 'doces'], calories: 152, time: "25 min", difficulty: "F√°cil", yield: "9 por√ß√µes", description: "Lanche.", ingredients: ["Banana", "Farinha", "Chocolate"], instructions: ["Asse em forminhas."] },
            { id: 30, title: "Muffins Salgados", displayCategory: "Caf√© Proteico", tags: ['cafe', 'proteina'], calories: 41, time: "35 min", difficulty: "F√°cil", yield: "9 por√ß√µes", description: "Ovos.", ingredients: ["Ovos", "Vegetais"], instructions: ["Asse em forminhas."] },
            { id: 31, title: "Panqueca Salgada", displayCategory: "Caf√© Proteico", tags: ['cafe', 'almoco'], calories: 476, time: "15 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Aveia.", ingredients: ["Aveia", "Ovos", "Recheio"], instructions: ["Fa√ßa disco, recheie."] },
            { id: 32, title: "Ovos Presunto", displayCategory: "Caf√© Salgado", tags: ['cafe', 'lowcarb'], calories: 230, time: "25 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "B√°sico.", ingredients: ["Ovos", "Presunto", "Espinafre"], instructions: ["Refogue e mexa."] },
            { id: 33, title: "Sufl√™ Mirtilo", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'doces'], calories: 300, time: "65 min", difficulty: "F√°cil", yield: "3 por√ß√µes", description: "Quente ou frio.", ingredients: ["Iogurte", "Ovos", "Mirtilo"], instructions: ["Bata e asse."] },
            { id: 34, title: "Wrap Omelete", displayCategory: "Almo√ßo/Jantar", tags: ['almoco', 'lowcarb'], calories: 352, time: "20 min", difficulty: "Normal", yield: "4 por√ß√µes", description: "Sem farinha.", ingredients: ["Ovos", "Recheio"], instructions: ["Fa√ßa disco de ovo, enrole."] },
            { id: 35, title: "Wrap Morango", displayCategory: "Doce Fit", tags: ['lanche', 'doces'], calories: 297, time: "10 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Doce.", ingredients: ["Tortilha", "Cream cheese", "Morango"], instructions: ["Recheie e enrole."] },
            { id: 36, title: "Rolinhos Piment√£o", displayCategory: "Lanche Leve", tags: ['lanche', 'lowcal'], calories: 353, time: "10 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Frio.", ingredients: ["Tortilha", "Piment√£o", "Cream cheese"], instructions: ["Recheie e corte."] },
            { id: 37, title: "Omelete Coreano", displayCategory: "Caf√©/Almo√ßo", tags: ['cafe', 'almoco'], calories: 303, time: "12 min", difficulty: "F√°cil", yield: "2 por√ß√µes", description: "Enrolado.", ingredients: ["Ovos", "Cenoura"], instructions: ["Frite enrolando."] },
            { id: 38, title: "P√£o Low Carb", displayCategory: "Caf√©/Lanche", tags: ['cafe', 'lowcarb'], calories: 165, time: "75 min", difficulty: "Normal", yield: "10 fatias", description: "Am√™ndoas.", ingredients: ["Farinha am√™ndoa", "Ovos"], instructions: ["Asse."] },
            { id: 39, title: "Ovos com Salm√£o", displayCategory: "Caf√© Proteico", tags: ['cafe', 'proteina'], calories: 500, time: "15 min", difficulty: "Normal", yield: "2 por√ß√µes", description: "Sofisticado.", ingredients: ["Ovos", "Salm√£o defumado"], instructions: ["Mexa tudo."] },
            { id: 40, title: "Sandu√≠che Peru", displayCategory: "Lanche Pr√°tico", tags: ['lanche', 'rapido'], calories: 313, time: "15 min", difficulty: "Normal", yield: "4 por√ß√µes", description: "Completo.", ingredients: ["P√£o integral", "Peito peru", "Salada"], instructions: ["Monte."] }
        ];

        // --- VIEWS ---

        const views = {
            home: `
                <div class="fade-in space-y-6">
                    <div class="bg-gradient-to-r from-bestie to-pink-400 rounded-3xl p-6 text-white shadow-lg shadow-pink-200">
                        <p class="text-pink-100 text-sm font-medium mb-1">Bom dia, Bestie! ‚ú®</p>
                        <h2 class="text-2xl font-bold mb-4">Vamos secar hoje?</h2>
                        <div class="flex gap-3">
                            <div class="bg-white/20 backdrop-blur rounded-xl p-3 flex-1">
                                <span class="block text-xs text-pink-100">√Ågua (35ml/kg)</span>
                                <span class="font-bold text-lg" id="home-water-goal">--</span>
                            </div>
                            <div class="bg-white/20 backdrop-blur rounded-xl p-3 flex-1">
                                <span class="block text-xs text-pink-100">Meta</span>
                                <span class="font-bold text-lg" id="home-meta-goal">--</span>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-lg text-gray-800">Atalhos</h3>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <!-- Existing Recipes -->
                            <button onclick="navigate('recipes')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-green-100 text-green-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-leaf"></i>
                                </div>
                                <span class="font-medium text-sm">Receitinhas</span>
                            </button>
                            <!-- Water (Visual) -->
                            <button onclick="navigate('water')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-blue-100 text-blue-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-glass-water"></i>
                                </div>
                                <span class="font-medium text-sm">√Ågua</span>
                            </button>
                            
                            <!-- Fim de Semana -->
                            <button onclick="navigate('weekend')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-purple-100 text-purple-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-calendar-check"></i>
                                </div>
                                <span class="font-medium text-sm">Fim de Semana</span>
                            </button>

                            <!-- Kit da Bestie -->
                            <button onclick="navigate('kit')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-teal-100 text-teal-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-kit-medical"></i>
                                </div>
                                <span class="font-medium text-sm">Kit da Bestie</span>
                            </button>

                            <!-- Trocas -->
                            <button onclick="navigate('swaps')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-orange-100 text-orange-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-repeat"></i>
                                </div>
                                <span class="font-medium text-sm">Trocas</span>
                            </button>

                            <!-- Economia -->
                            <button onclick="navigate('savings')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-yellow-100 text-yellow-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-piggy-bank"></i>
                                </div>
                                <span class="font-medium text-sm">Economia</span>
                            </button>

                            <!-- Treino -->
                            <button onclick="navigate('workout')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-red-100 text-red-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-dumbbell"></i>
                                </div>
                                <span class="font-medium text-sm">Treino</span>
                            </button>

                            <!-- SOS Bestie -->
                            <button onclick="navigate('sos')" class="bg-white p-4 rounded-2xl shadow-sm border border-pink-50 flex flex-col items-center gap-2 hover:border-bestie transition group">
                                <div class="w-12 h-12 rounded-full bg-indigo-100 text-indigo-500 flex items-center justify-center group-hover:scale-110 transition">
                                    <i class="fa-solid fa-bell"></i>
                                </div>
                                <span class="font-medium text-sm">SOS Bestie</span>
                            </button>
                        </div>
                    </div>
                </div>
            `,
            recipes: `
                <div class="fade-in">
                    <div class="mb-6 flex justify-between items-end">
                        <div><h2 class="text-2xl font-bold text-gray-800">Receitinhas ü•ó</h2><p class="text-gray-500 text-sm">Coma bem sem culpa!</p></div>
                        <button onclick="navigate('chefBestie')" class="bg-gradient-to-r from-bestie to-pink-400 text-white px-4 py-2 rounded-xl text-xs font-bold shadow-lg hover:scale-105 transition flex items-center gap-2 animate-pulse"><i class="fa-solid fa-wand-magic-sparkles"></i> Chef Bestie</button>
                    </div>
                    <div class="relative mb-6"><i class="fa-solid fa-search absolute left-4 top-3.5 text-gray-400 text-sm"></i><input type="text" placeholder="O que vamos cozinhar?" class="w-full bg-white border border-pink-100 rounded-full py-3 pl-10 pr-4 text-sm focus:outline-none focus:border-bestie shadow-sm"></div>
                    <div class="flex gap-2 overflow-x-auto hide-scrollbar mb-6 pb-2 px-1">
                        <button onclick="filterRecipes('all', this)" class="cat-btn active flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-bestie text-white shadow-md transition">Tudo</button>
                        <button onclick="filterRecipes('cafe', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Caf√©</button>
                        <button onclick="filterRecipes('almoco', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Almo√ßo</button>
                        <button onclick="filterRecipes('jantar', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Jantar</button>
                        <button onclick="filterRecipes('lowcarb', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Low Carb</button>
                        <button onclick="filterRecipes('proteina', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Proteicos</button>
                        <button onclick="filterRecipes('doces', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Doces Fit</button>
                        <button onclick="filterRecipes('vegano', this)" class="cat-btn flex-shrink-0 px-4 py-2 rounded-full text-xs font-semibold bg-white text-gray-500 border border-pink-100 hover:text-bestie transition">Vegano</button>
                    </div>
                    <div id="recipe-grid" class="grid grid-cols-1 gap-4 pb-20"></div>
                </div>
            `,
            chefBestie: `
                <div class="fade-in pb-20">
                    <div class="mb-6 flex items-center gap-3">
                        <button onclick="navigate('recipes')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button>
                        <h2 class="text-2xl font-bold text-gray-800">Chef Bestie ‚ú®</h2>
                    </div>
                    <div class="bg-gradient-to-br from-purple-50 to-pink-50 border border-pink-100 rounded-3xl p-6 shadow-sm mb-6">
                        <p class="text-gray-600 text-sm mb-4">Me conte o que voc√™ tem na geladeira e eu crio uma receitinha m√°gica!</p>
                        <div class="relative"><textarea id="ai-ingredients" rows="3" placeholder="Ex: frango, batata doce, br√≥colis..." class="w-full bg-white border border-pink-200 rounded-2xl p-4 text-sm focus:outline-none focus:border-bestie resize-none"></textarea></div>
                        <button onclick="generateAIRecipe()" id="generate-btn" class="w-full mt-4 bg-gradient-to-r from-bestie to-pink-400 text-white py-3 rounded-xl font-bold shadow-lg hover:scale-[1.02] transition flex items-center justify-center gap-2"><span>Criar Receita M√°gica</span><i class="fa-solid fa-wand-magic-sparkles"></i></button>
                    </div>
                    <div id="ai-result" class="hidden space-y-4">
                        <div class="flex items-center gap-2 text-sm text-gray-400 uppercase font-bold tracking-wider mb-2"><i class="fa-solid fa-star text-yellow-400"></i> Resultado</div>
                        <div id="ai-recipe-card"></div>
                    </div>
                </div>
            `,
            calculator: `
                <div class="fade-in pb-20 pt-6">
                    <div class="mb-6 text-center">
                        <div class="w-16 h-16 bg-pink-100 text-bestie rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce"><i class="fa-solid fa-wand-magic-sparkles text-2xl"></i></div>
                        <h2 class="text-xl font-bold text-gray-800">Calculadora M√°gica ‚ú®</h2>
                        <p class="text-gray-500 mt-2 text-sm">Descubra suas metas ideais!</p>
                    </div>
                    <div class="bg-white rounded-3xl p-6 shadow-sm border border-pink-100 space-y-4">
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Idade</label><input type="number" id="calc-age" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie" placeholder="Ex: 25"></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Peso (kg)</label><input type="number" id="calc-weight" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie" placeholder="Ex: 60"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Altura (cm)</label><input type="number" id="calc-height" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie" placeholder="Ex: 165"></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Meta (kg)</label><input type="number" id="calc-target-weight" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie" placeholder="Ex: 55"></div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Objetivo</label>
                            <select id="calc-goal" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie text-gray-600">
                                <option value="perder">Secar (Perder Peso)</option>
                                <option value="manter">Manter Peso</option>
                                <option value="ganhar">Ganhar Massa</option>
                            </select>
                        </div>
                        <button onclick="generatePlan()" id="plan-btn" class="w-full mt-4 bg-bestie text-white py-3 rounded-xl font-bold shadow-lg hover:scale-[1.02] transition">Gerar Plano Personalizado ‚ú®</button>
                    </div>
                    <div id="plan-result" class="hidden mt-6 space-y-4">
                        <div class="bg-gradient-to-r from-bestie to-pink-400 rounded-3xl p-6 text-white shadow-lg text-center">
                            <h3 class="font-bold text-lg mb-2">Sua Meta Di√°ria</h3>
                            <div class="text-4xl font-bold mb-1" id="plan-calories">0000</div>
                            <div class="text-pink-100 text-sm mb-4">kcal / dia</div>
                            <div class="flex gap-2 justify-center text-xs">
                                <div class="bg-white/20 p-2 rounded flex-1">Prot <br><b id="plan-protein">0g</b></div>
                                <div class="bg-white/20 p-2 rounded flex-1">Carb <br><b id="plan-carbs">0g</b></div>
                                <div class="bg-white/20 p-2 rounded flex-1">Gord <br><b id="plan-fats">0g</b></div>
                            </div>
                            <div class="mt-4 text-xs bg-black/10 rounded p-1" id="plan-bmi"></div>
                        </div>
                        <div class="bg-white rounded-2xl p-5 border border-purple-100 shadow-sm"><h4 class="font-bold text-purple-600 mb-2 text-sm"><i class="fa-solid fa-lightbulb"></i> Dica da Bestie</h4><p class="text-xs text-gray-600" id="plan-tip"></p></div>
                        <div class="bg-yellow-50 rounded-2xl p-5 border border-yellow-100 shadow-sm text-center"><p class="text-xs text-gray-600 italic font-medium" id="plan-quote"></p></div>
                    </div>
                </div>
            `,
            profile: `
                <div class="fade-in pb-20 pt-6">
                    <div class="mb-6 text-center">
                        <div class="w-20 h-20 bg-pink-100 rounded-full mx-auto mb-4 border-4 border-white shadow-md overflow-hidden"><img src="" id="profile-avatar" alt="Profile" /></div>
                        <h2 class="text-xl font-bold text-gray-800">Seu Perfil üíñ</h2>
                    </div>
                    <div class="bg-white rounded-3xl p-6 shadow-sm border border-pink-100 space-y-4">
                        <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Nome</label><input type="text" id="profile-name" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Idade</label><input type="number" id="profile-age" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie"></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Peso (kg)</label><input type="number" id="profile-weight" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie"></div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Altura (cm)</label><input type="number" id="profile-height" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie"></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Meta (kg)</label><input type="number" id="profile-target-weight" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie"></div>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Objetivo</label>
                            <select id="profile-goal" class="w-full bg-gray-50 border border-pink-100 rounded-xl p-3 text-sm focus:outline-none focus:border-bestie text-gray-600">
                                <option value="perder">Secar (Perder Peso)</option>
                                <option value="manter">Manter Peso</option>
                                <option value="ganhar">Ganhar Massa</option>
                            </select>
                        </div>
                        <button onclick="saveProfile()" class="w-full mt-4 bg-bestie text-white py-3 rounded-xl font-bold shadow-lg hover:scale-[1.02] transition">Salvar Dados</button>
                    </div>
                </div>
            `,
            workout: `
                <div class="fade-in pb-20">
                    <div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Treino da Bestie üèãÔ∏è‚Äç‚ôÄÔ∏è</h2></div>
                    <div class="bg-gradient-to-br from-red-50 to-pink-50 border border-red-100 rounded-3xl p-6 shadow-sm mb-6">
                        <p class="text-gray-600 text-sm mb-4">Escolha como voc√™ quer treinar hoje!</p>
                        <div class="space-y-4">
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Tempo</label><select id="workout-time" class="w-full bg-white border border-pink-200 rounded-xl p-3 text-sm focus:outline-none"><option value="15">15 min (R√°pido)</option><option value="30">30 min (M√©dio)</option><option value="45">45 min (Completo)</option></select></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Foco</label><select id="workout-focus" class="w-full bg-white border border-pink-200 rounded-xl p-3 text-sm focus:outline-none"><option value="Full Body">Corpo Todo</option><option value="Legs">Pernas</option><option value="Upper">Bra√ßos</option><option value="Cardio">Cardio</option></select></div>
                            <div><label class="block text-xs font-bold text-gray-500 mb-1 ml-1">Equipamento</label><select id="workout-equip" class="w-full bg-white border border-pink-200 rounded-xl p-3 text-sm focus:outline-none"><option value="Bodyweight">Peso do Corpo</option><option value="Dumbbells">Pesos</option><option value="Gym">Academia</option></select></div>
                        </div>
                        <button onclick="generateWorkout()" id="workout-btn" class="w-full mt-6 bg-gradient-to-r from-red-400 to-pink-500 text-white py-3 rounded-xl font-bold shadow-lg hover:scale-[1.02] transition flex items-center justify-center gap-2"><span>Gerar Treino</span><i class="fa-solid fa-fire"></i></button>
                    </div>
                    <div id="workout-result" class="hidden space-y-4"><div id="workout-card"></div></div>
                </div>
            `,
            water: `
                 <div class="fade-in pb-20 pt-6">
                    <div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Hidrata√ß√£o üíß</h2></div>
                    <div class="text-center mb-8">
                        <div class="relative w-40 h-40 mx-auto mb-4 bg-blue-50 rounded-full flex items-center justify-center border-4 border-white shadow-lg overflow-hidden">
                            <div id="water-level" class="absolute bottom-0 left-0 w-full bg-blue-400 transition-all duration-500 ease-out" style="height: 0%"></div>
                            <span id="water-count" class="relative text-3xl font-bold text-blue-600 z-10">0</span>
                            <span class="relative text-xs text-blue-400 mt-8 -ml-4 z-10" id="water-goal-total-cups">/10</span>
                        </div>
                        <p class="text-gray-500 text-sm">Meta: <span id="water-goal-liters" class="font-bold text-blue-600">2.5L</span></p>
                    </div>
                    <div class="flex justify-center gap-6"><button onclick="updateWater(-1)" class="w-14 h-14 rounded-full bg-white border border-gray-200 text-gray-400 flex items-center justify-center text-xl shadow-sm hover:scale-105 transition"><i class="fa-solid fa-minus"></i></button><button onclick="updateWater(1)" class="w-14 h-14 rounded-full bg-blue-500 text-white flex items-center justify-center text-xl shadow-lg shadow-blue-200 hover:scale-105 transition"><i class="fa-solid fa-plus"></i></button></div>
                </div>
            `,
            weekend: `
                 <div class="fade-in pb-20"><div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Fim de Semana üçï</h2></div><div class="bg-white rounded-3xl p-6 shadow-sm border border-pink-100 space-y-4"><div class="bg-purple-50 rounded-xl p-4 border border-purple-100"><h3 class="font-bold text-purple-700 mb-2">Regra de Ouro</h3><p class="text-sm text-gray-600">2 refei√ß√µes livres (S√°bado/Domingo)!</p></div></div></div>
            `,
            kit: `
                 <div class="fade-in pb-20"><div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Kit da Bestie üíä</h2></div><div class="space-y-4"><div class="bg-white rounded-2xl p-4 shadow-sm border border-pink-50 flex items-center gap-4"><div class="w-12 h-12 rounded-full bg-blue-50 text-blue-500 flex items-center justify-center text-xl">üí™</div><div><h3 class="font-bold text-gray-800">Whey</h3><p class="text-xs text-gray-500">P√≥s-treino.</p></div></div></div></div>
            `,
            swaps: `
                 <div class="fade-in pb-20"><div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Trocas üîÑ</h2></div>
                 <div class="bg-gradient-to-br from-orange-50 to-pink-50 border border-orange-100 rounded-3xl p-6 shadow-sm mb-6"><div class="relative"><input type="text" id="swap-input" placeholder="Ex: Coxinha..." class="w-full bg-white border border-orange-200 rounded-2xl p-4 text-sm focus:outline-none focus:border-bestie"><button onclick="generateSwap()" id="swap-btn" class="absolute right-2 top-2 bg-orange-400 text-white p-2 rounded-xl hover:bg-orange-500 transition shadow-md"><i class="fa-solid fa-magnifying-glass"></i></button></div><div id="swap-result" class="hidden mt-4 bg-white rounded-xl p-4 border border-orange-100 shadow-sm"><p id="swap-text" class="text-sm text-gray-600 italic"></p></div></div>
                 <div class="bg-white rounded-3xl overflow-hidden shadow-sm border border-pink-100"><table class="w-full text-sm text-left text-gray-600"><thead class="bg-pink-50 text-bestie uppercase text-xs"><tr><th class="px-4 py-3">Troque</th><th class="px-4 py-3">Por</th></tr></thead><tbody class="divide-y divide-pink-50"><tr><td class="px-4 py-3">A√ß√∫car</td><td class="px-4 py-3 font-medium text-green-600">Ado√ßante</td></tr></tbody></table></div></div>
            `,
            savings: `
                 <div class="fade-in pb-20"><div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">Economia üí∞</h2></div><div class="bg-yellow-50 border border-yellow-100 rounded-3xl p-6 shadow-sm mb-6"><h3 class="font-bold text-yellow-700 text-lg mb-2 flex items-center gap-2"><i class="fa-solid fa-star"></i> Dica</h3><p class="text-sm text-yellow-800">Compre a granel!</p></div></div>
            `,
            sos: `
                 <div class="fade-in pb-20"><div class="mb-6 flex items-center gap-3"><button onclick="navigate('home')" class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center hover:bg-pink-100 transition"><i class="fa-solid fa-arrow-left"></i></button><h2 class="text-2xl font-bold text-gray-800">SOS üÜò</h2></div><div class="bg-gradient-to-br from-indigo-50 to-pink-50 border border-indigo-100 rounded-3xl p-6 shadow-sm mb-6"><p class="text-gray-600 text-sm mb-4">Qual a emerg√™ncia?</p><div class="relative"><input type="text" id="sos-input" placeholder="Ex: Jaquei..." class="w-full bg-white border border-indigo-200 rounded-xl p-3 text-sm focus:outline-none"><button onclick="triggerSOS(document.getElementById('sos-input').value)" class="absolute right-2 top-2 w-8 h-8 bg-indigo-400 text-white rounded-lg flex items-center justify-center"><i class="fa-solid fa-paper-plane text-xs"></i></button></div></div><div id="sos-result" class="hidden space-y-4"><div class="bg-white rounded-2xl p-5 border border-indigo-100 shadow-sm"><p class="text-sm text-gray-600 leading-relaxed mt-2" id="sos-text">...</p></div></div></div>
            `
        };

        // --- INIT & NAV ---
        function init() { navigate('home'); }

        function navigate(viewName) {
            const main = document.getElementById('app-content');
            if (views[viewName]) {
                main.innerHTML = views[viewName];
            } else { console.error(`View ${viewName} not found`); return; }

            if(viewName === 'profile') {
                setTimeout(() => {
                    document.getElementById('profile-name').value = userProfile.name || '';
                    document.getElementById('profile-age').value = userProfile.age || '';
                    document.getElementById('profile-weight').value = userProfile.weight || '';
                    document.getElementById('profile-target-weight').value = userProfile.targetWeight || '';
                    document.getElementById('profile-height').value = userProfile.height || '';
                    document.getElementById('profile-goal').value = userProfile.goal || 'perder';
                    document.getElementById('profile-avatar').src = `https://api.dicebear.com/7.x/avataaars/svg?seed=${userProfile.name || 'Bestie'}`;
                }, 0);
            }
            if(viewName === 'calculator') {
                 setTimeout(() => {
                    if(userProfile.age) document.getElementById('calc-age').value = userProfile.age;
                    if(userProfile.weight) document.getElementById('calc-weight').value = userProfile.weight;
                    if(userProfile.targetWeight) document.getElementById('calc-target-weight').value = userProfile.targetWeight;
                    if(userProfile.height) document.getElementById('calc-height').value = userProfile.height;
                    if(userProfile.goal) document.getElementById('calc-goal').value = userProfile.goal;
                }, 0);
            }
            if(viewName === 'water') {
                if (userProfile.weight) {
                    waterGoalLiters = (userProfile.weight * 0.035).toFixed(1);
                    waterGoalCups = Math.ceil((waterGoalLiters * 1000) / 250);
                }
                setTimeout(() => {
                    document.getElementById('water-goal-liters').innerText = waterGoalLiters + 'L';
                    document.getElementById('water-goal-total-cups').innerText = '/' + waterGoalCups;
                    updateWater(0);
                }, 0);
            }
            if(viewName === 'recipes') { setTimeout(() => renderRecipes('all'), 0); }
            if (viewName === 'home') {
                setTimeout(() => {
                    if(userProfile.weight) {
                         const l = (userProfile.weight * 0.035).toFixed(1);
                         document.getElementById('home-water-goal').innerText = l + 'L';
                    }
                    if(userProfile.targetWeight) {
                        document.getElementById('home-meta-goal').innerText = userProfile.targetWeight + 'kg';
                    }
                }, 0);
            }
        }

        // --- LOGIC ---
        function saveProfile() {
            const name = document.getElementById('profile-name').value;
            const age = document.getElementById('profile-age').value;
            const weight = document.getElementById('profile-weight').value;
            const targetWeight = document.getElementById('profile-target-weight').value;
            const height = document.getElementById('profile-height').value;
            const goal = document.getElementById('profile-goal').value;

            userProfile = { name, age, weight, targetWeight, height, goal };
            localStorage.setItem('bestieProfile', JSON.stringify(userProfile));
            document.getElementById('profile-avatar').src = `https://api.dicebear.com/7.x/avataaars/svg?seed=${name}`;
            alert('Perfil salvo com sucesso! üíñ');
        }

        function updateWater(change) {
            waterIntake += change;
            if(waterIntake < 0) waterIntake = 0;
            const countEl = document.getElementById('water-count');
            const fillEl = document.getElementById('water-level');
            if(countEl && fillEl) {
                countEl.innerText = waterIntake;
                let percentage = (waterIntake / waterGoalCups) * 100;
                if(percentage > 100) percentage = 100;
                fillEl.style.height = `${percentage}%`;
            }
        }

        // --- RECIPE LOGIC ---
        function filterRecipes(tag, btn) {
            document.querySelectorAll('.cat-btn').forEach(b => {
                b.classList.remove('bg-bestie', 'text-white', 'shadow-md');
                b.classList.add('bg-white', 'text-gray-500', 'border');
            });
            btn.classList.remove('bg-white', 'text-gray-500', 'border');
            btn.classList.add('bg-bestie', 'text-white', 'shadow-md');
            renderRecipes(tag);
        }

        function renderRecipes(tag) {
            const grid = document.getElementById('recipe-grid');
            if(!grid) return;
            grid.innerHTML = '';
            const filtered = tag === 'all' ? recipes : recipes.filter(r => r.tags && r.tags.includes(tag));
            
            if(filtered.length === 0) {
                grid.innerHTML = '<div class="text-center py-10 text-gray-400"><p>Nenhuma receitinha encontrada :(</p></div>';
                return;
            }

            filtered.forEach(r => {
                const div = document.createElement('div');
                div.className = "bg-white rounded-2xl p-4 shadow-sm border border-pink-50 flex gap-4 hover:border-pink-200 transition cursor-pointer";
                div.onclick = () => openRecipe(r.id);
                div.innerHTML = `
                    <div class="flex-1 flex flex-col justify-center">
                        <div class="flex justify-between items-start"><h3 class="font-bold text-gray-800 leading-tight">${r.title}</h3><i class="fa-regular fa-bookmark text-gray-300"></i></div>
                        <div class="flex flex-wrap gap-1 mt-1.5"><span class="text-[10px] text-bestie font-bold bg-pink-50 px-2 py-0.5 rounded">${r.calories} kcal</span><span class="text-[10px] text-gray-500 bg-gray-100 px-2 py-0.5 rounded">${r.displayCategory}</span></div>
                        <div class="mt-auto flex items-center gap-3 text-xs text-gray-400 mt-2"><span class="flex items-center gap-1"><i class="fa-regular fa-clock"></i> ${r.time}</span></div>
                    </div>
                    <div class="flex items-center justify-center pr-1"><button class="w-8 h-8 rounded-full bg-pink-50 text-bestie flex items-center justify-center"><i class="fa-solid fa-chevron-right text-xs"></i></button></div>
                `;
                grid.appendChild(div);
            });
        }

        function openRecipe(id) {
            const r = recipes.find(x => x.id === id);
            if(!r) return;
            document.getElementById('modal-tag').innerText = r.displayCategory;
            document.getElementById('modal-title').innerText = r.title;
            document.getElementById('modal-cal').innerText = r.calories;
            document.getElementById('modal-time').innerText = r.time;
            document.getElementById('modal-difficulty').innerText = r.difficulty;
            document.getElementById('modal-yield').innerText = r.yield;

            const desc = r.description || "";
            if (desc.includes("Dica:")) {
                const parts = desc.split("Dica:");
                document.getElementById('modal-desc').innerText = parts[0].trim();
                document.getElementById('modal-tip-text').innerText = parts[1].trim();
                document.getElementById('modal-tip-container').classList.remove('hidden');
            } else {
                document.getElementById('modal-desc').innerText = desc;
                document.getElementById('modal-tip-container').classList.add('hidden');
            }

            document.getElementById('modal-ingredients').innerHTML = r.ingredients.map(i => `<li class="flex items-start gap-2"><span class="w-1.5 h-1.5 rounded-full bg-bestie mt-1.5 flex-shrink-0"></span>${i}</li>`).join('');
            document.getElementById('modal-instructions').innerHTML = r.instructions.map((s, i) => `<div class="flex gap-3"><div class="w-6 h-6 rounded-full bg-pink-100 text-bestie text-xs font-bold flex items-center justify-center flex-shrink-0">${i+1}</div><p class="leading-snug">${s}</p></div>`).join('');
            
            const modal = document.getElementById('recipe-modal');
            const panel = document.getElementById('modal-panel');
            modal.classList.remove('hidden');
            setTimeout(() => panel.classList.remove('translate-y-full'), 10);
        }

        function closeRecipeModal() {
            const modal = document.getElementById('recipe-modal');
            const panel = document.getElementById('modal-panel');
            panel.classList.add('translate-y-full');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        // --- AI CALLS ---
        async function fetchAI(prompt, jsonMode = true) {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const body = { contents: [{ parts: [{ text: prompt }] }] };
            if(jsonMode) body.generationConfig = { responseMimeType: "application/json" };
            
            try {
                let r = await fetch(url, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(body) });
                if (!r.ok) return null;
                let d = await r.json();
                let txt = d.candidates[0].content.parts[0].text;
                if(jsonMode) {
                     txt = txt.replace(/```json/gi, '').replace(/```/g, '').trim();
                     return JSON.parse(txt);
                }
                return txt;
            } catch (e) { console.error(e); return null; }
        }

        async function generateAIRecipe() {
            const ing = document.getElementById('ai-ingredients').value;
            if(!ing) return;
            const btn = document.getElementById('generate-btn');
            btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Criando...`; btn.disabled = true;
            document.getElementById('ai-result').classList.add('hidden');

            const p = `Crie uma receita saud√°vel com: ${ing}. JSON: {"title":"", "calories":0, "time":"", "difficulty":"", "yield":"", "description":"Dica:...", "ingredients":[], "instructions":[], "category":"almoco"}`;
            const data = await fetchAI(p, true);

            if(data) {
                document.getElementById('ai-recipe-card').innerHTML = `
                    <div class="bg-white rounded-3xl p-5 shadow-lg border border-pink-100 relative">
                        <div class="absolute top-0 right-0 bg-bestie text-white text-xs font-bold px-3 py-1 rounded-bl-xl">IA ‚ú®</div>
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${data.title}</h3>
                        <p class="text-sm text-gray-500 italic mb-4">${data.description}</p>
                        <div class="flex gap-4 text-xs text-gray-500 mb-4 bg-pink-50 p-3 rounded-xl"><span>üî• ${data.calories} kcal</span><span>‚è∞ ${data.time}</span></div>
                        <h4 class="font-bold text-sm mb-2">Ingredientes:</h4><ul class="text-sm text-gray-600 list-disc pl-4 mb-4">${data.ingredients.map(i=>`<li>${i}</li>`).join('')}</ul>
                        <h4 class="font-bold text-sm mb-2">Preparo:</h4><ol class="text-sm text-gray-600 list-decimal pl-4">${data.instructions.map(i=>`<li>${i}</li>`).join('')}</ol>
                    </div>`;
                document.getElementById('ai-result').classList.remove('hidden');
            } else { alert("Erro na IA."); }
            btn.innerHTML = `<span>Criar Outra</span> <i class="fa-solid fa-wand-magic-sparkles"></i>`; btn.disabled = false;
        }

        async function generatePlan() {
            const age = document.getElementById('calc-age').value;
            const weight = document.getElementById('calc-weight').value;
            const tWeight = document.getElementById('calc-target-weight').value;
            const height = document.getElementById('calc-height').value;
            const goal = document.getElementById('calc-goal').value;
            if(!age || !weight || !height) { alert("Preencha tudo!"); return; }

            const btn = document.getElementById('plan-btn');
            btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Calculando...`; btn.disabled = true;
            document.getElementById('plan-result').classList.add('hidden');
            
            // Update profile with calculator data
            userProfile.age = age;
            userProfile.weight = weight;
            userProfile.targetWeight = tWeight;
            userProfile.height = height;
            userProfile.goal = goal;
            localStorage.setItem('bestieProfile', JSON.stringify(userProfile));

            const p = `Plano nutricional: ${age}anos, ${weight}kg, Meta:${tWeight}kg, ${height}cm, ${goal}. JSON: {"calories_target":"", "bmi":"", "macros":{"protein":"", "carbs":"", "fats":""}, "motivational_quote":"", "tip":""}`;
            const data = await fetchAI(p, true);

            if(data) {
                document.getElementById('plan-calories').innerText = data.calories_target;
                document.getElementById('plan-protein').innerText = data.macros.protein;
                document.getElementById('plan-carbs').innerText = data.macros.carbs;
                document.getElementById('plan-fats').innerText = data.macros.fats;
                document.getElementById('plan-tip').innerText = data.tip;
                document.getElementById('plan-quote').innerText = `"${data.motivational_quote}"`;
                document.getElementById('plan-bmi').innerText = `IMC: ${data.bmi}`;
                document.getElementById('plan-result').classList.remove('hidden');
            } else { alert("Erro na IA."); }
            btn.innerHTML = `Gerar Plano Personalizado ‚ú®`; btn.disabled = false;
        }

        async function generateWorkout() {
            const t = document.getElementById('workout-time').value;
            const f = document.getElementById('workout-focus').value;
            const e = document.getElementById('workout-equip').value;
            const btn = document.getElementById('workout-btn');
            btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Montando...`; btn.disabled = true;
            document.getElementById('workout-result').classList.add('hidden');

            const p = `Treino: ${t}min, ${f}, ${e}. JSON: {"title":"", "warmup":"", "exercises":[{"name":"", "reps":"", "tips":""}], "motivation":""}`;
            const data = await fetchAI(p, true);

            if(data) {
                document.getElementById('workout-card').innerHTML = `
                    <div class="bg-white rounded-3xl p-5 shadow-lg border border-red-100 relative"><h3 class="text-xl font-bold text-gray-800 mb-2">${data.title}</h3>
                    <div class="bg-red-50 p-3 rounded-xl mb-4"><span class="text-xs font-bold text-red-500 uppercase">Aquecimento</span><p class="text-sm">${data.warmup}</p></div>
                    <ul class="space-y-3 mb-4">${data.exercises.map(ex => `<li class="bg-gray-50 p-3 rounded-xl border border-gray-100"><div class="flex justify-between items-center mb-1"><span class="font-bold text-gray-700 text-sm">${ex.name}</span><span class="text-xs font-bold bg-white px-2 py-1 rounded text-red-500 border border-red-100">${ex.reps}</span></div><p class="text-xs text-gray-500 italic">${ex.tips}</p></li>`).join('')}</ul>
                    <div class="bg-yellow-50 rounded-xl p-4 text-center border border-yellow-100"><p class="text-sm text-gray-600 italic">"${data.motivation}"</p></div></div>`;
                document.getElementById('workout-result').classList.remove('hidden');
            } else { alert("Erro na IA."); }
            btn.innerHTML = `<span>Gerar Treino</span> <i class="fa-solid fa-fire"></i>`; btn.disabled = false;
        }

        async function triggerSOS(sit) {
            if(!sit) return;
            const resDiv = document.getElementById('sos-result');
            const txt = document.getElementById('sos-text');
            txt.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i> Buscando ajuda...`;
            resDiv.classList.remove('hidden');
            const data = await fetchAI(`Conselho curto e divertido para: "${sit}"`, false);
            txt.innerText = data || "Erro na conex√£o. Respira fundo! üíñ";
        }

        async function generateSwap() {
             const input = document.getElementById('swap-input');
             if(!input.value.trim()) return;
             const btn = document.getElementById('swap-btn');
             const resDiv = document.getElementById('swap-result');
             const txt = document.getElementById('swap-text');
             
             const originalIcon = btn.innerHTML;
             btn.innerHTML = `<i class="fa-solid fa-spinner fa-spin"></i>`;
             resDiv.classList.add('hidden');

             const p = `Substitui√ß√£o saud√°vel e fit para '${input.value}'. Explique o porqu√™ curto e com emoji.`;
             const data = await fetchAI(p, false); // False because we want plain text response

             if(data) {
                 txt.innerText = data;
                 resDiv.classList.remove('hidden');
             } else { alert("Ops! Tente de novo."); }
             btn.innerHTML = originalIcon;
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
